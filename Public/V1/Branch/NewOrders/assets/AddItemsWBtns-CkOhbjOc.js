var k=Object.defineProperty,J=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var B=(e,t,a)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,f=(e,t)=>{for(var a in t||(t={}))x.call(t,a)&&B(e,a,t[a]);if(A)for(var a of A(t))q.call(t,a)&&B(e,a,t[a]);return e},S=(e,t)=>J(e,U(t));import{S as W}from"./EntryFile-BphKqlzn.js";let G=()=>{_()},_=()=>{const e=new URL(window.location.href),t=new URL("./Customer.html",e);let a=Y(),l=z();t.searchParams.append("CustomerMobile",a),t.searchParams.append("CustomerName",l),window.location.href=t.href},Y=()=>{let t=document.getElementById("CustomerMobileId");if(t!==null)return t.value.trim()},z=()=>{let t=document.getElementById("CustomerNameId");if(t!==null)return t.value.trim()},Q=()=>{let e=document.getElementById("BranchNameAnchorId");e!==null&&e.addEventListener("click",G)};const X=()=>{var e=$("#table").bootstrapTable("getData");return e.length===0?(window.alert("Please Add Items"),!1):!0};let Z=()=>{X()&&ee()},ee=()=>{const e=new URL(window.location.href),t=new URL("./Settlement.html",e);let a=te();t.searchParams.append("OrderNumber",a),window.location.href=t.href},te=()=>{let t=document.getElementById("OrderNumberId");if(t!==null)return t.innerHTML.trim()},ae=()=>{let e=document.getElementById("CheckOutButtonId");e!==null&&e.addEventListener("click",Z)},le=()=>{Q(),ae()},oe=()=>!(re()===!1||ne()===!1||de()===!1||ce()===!1||me()===!1||se()===!1);const re=()=>{let e=document.getElementById("TableFooterItemNameId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},ne=()=>{let e=document.getElementById("TableFooterPcsInputId");return e.value===""||e.value<=0?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},de=()=>{let e=document.getElementById("exampleFormControlInput1");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},ce=()=>{let e=document.getElementById("TableFooterFactoryInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},me=()=>{let e=document.getElementById("TableFooterdateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},se=()=>{let e=document.getElementById("TableFooterRateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},ue="POST",Ie={Accept:"application/json","Content-Type":"application/json"},ie="",C={method:ue,headers:Ie,body:ie},Le="binV4",je="Transactions",Fe="Kakinada",fe={OrderKey:"PresentOrder",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns",PresentOrderAddOnsKey:"PresentOrderAddOns"},Se={ItemsTable:{DeleteUrl_Common:"$tableName/SubTable/Delete/SubKey/:Id/:inKey/:SubId",DeleteAddOnUrl:"/Custom/Cleaning/Branch/Order/NewOrder/addOn/$tableName/:Id/:SubId/:AddOnKey",DeleteItemUrl:"/Custom/Cleaning/Branch/Order/NewOrder/Item/$tableName/:Id/:SubId",AlterGetUrl:"/Custom/Cleaning/Branch/Order/SubTable/ItemsInOrder/:Id/:SubId/$tableName"}},ye={AddOnModal:"AddOnModal"},I={routePath:Le,folderName:je,tableName:Fe,localStorageKeys:fe,ApiUrls:Se,ModalIds:ye};let Ve=({inCategory:e,inItemType:t})=>{let a=I.localStorageKeys.ItemNamesKey,l=localStorage.getItem(a);return JSON.parse(l).filter(c=>c.Category===e&&c.ItemType===t)},p=({inCategory:e,inItemType:t,inService:a})=>{let l=I.localStorageKeys.ItemNamesKey,o=localStorage.getItem(l);return JSON.parse(o).find(m=>m.Category===e&&m.ItemType===t&&m.Service===a)},V=()=>{let e=I.localStorageKeys.ItemNamesKey,t=localStorage.getItem(e);return JSON.parse(t)};const ge=()=>{let e=pe(),t=Te(),a=Oe(),l=ve(),o=Be(),r=$e(),c=Ae();const m=be();localStorage.setItem("DeliveryDateTime",JSON.stringify(c));let u=JSON.parse(localStorage.getItem("PresentOrderAddOns"));const n=p({inCategory:e,inItemType:t,inService:m});let d={};return d.Category=e,d.ItemName=n.ItemName,d.ItemType=t,d.Rate=a,d.Pcs=l,d.Total=o,d.location=r,d.DeliveryDateTime=c,d.ItemService=m,d.AddOnArray=u,d};let be=()=>{let t=document.getElementById("TableFooterItemServiceId");if(t!==null)return t.value.trim()},pe=()=>document.getElementById("ItemTypeLabelId").dataset.itemCategory,Te=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},Oe=()=>{let t=document.getElementById("TableFooterRateInputId");if(t!==null)return t.value.trim()},ve=()=>{let t=document.getElementById("TableFooterPcsInputId");if(t!==null)return t.value.trim()},$e=()=>{let t=document.getElementById("TableFooterFactoryInputId");if(t!==null)return t.value.trim()},Ae=()=>{let t=document.getElementById("TableFooterdateInputId");if(t!==null)return t.value.trim()},Be=()=>{let t=document.getElementById("TableFooterRateInputId"),l=document.getElementById("TableFooterPcsInputId"),o=JSON.parse(localStorage.getItem("PresentOrderAddOns")),r=o!==null?o.map(m=>m.AddOnRate).reduce((m,u)=>m+parseInt(u),0):0,c=parseInt(t.value)+r;return console.log("Total:",c*l.value),c*l.value},Ce=()=>(C.body=JSON.stringify(ge()),C),he=async()=>{let e=localStorage.getItem("BranchName"),t=parseInt(document.getElementById("OrderNumberId").innerHTML),a=Ce(),l=`/Custom/Cleaning/Branch/Order/NewOrderV2/${e}/${t}/ItemsInOrder`;return await await fetch(l,a)},j=async()=>{localStorage.getItem("BranchName");let e=I.localStorageKeys.OrderKey,l=await(await fetch("/V3/BranOrdersKKD/Read/MaxRow")).json();localStorage.setItem(e,JSON.stringify(l))};const Ne=()=>{let e=I.localStorageKeys.OrderKey,t=localStorage.getItem(e),a=t?JSON.parse(t):{};return Ee({inItemsObject:a.ItemsInOrder||{}})},Ee=({inItemsObject:e})=>Object.entries(e).map(([t,a])=>S(f({},a),{pk:t})),F=()=>{let e=Ne();var t=$("#table");t.bootstrapTable("load",e)};let He=()=>{Re(),T()},Re=()=>{let t=document.getElementById("BranchNameId"),a=localStorage.getItem("BranchName");t!==null&&(t.innerHTML=a)};const T=()=>{var e=new Date,t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),l=e.getFullYear(),o=l+"-"+a+"-"+t;e.setDate(e.getDate()+7);var r=String(e.getDate()).padStart(2,"0"),c=String(e.getMonth()+1).padStart(2,"0"),m=e.getFullYear(),u=m+"-"+c+"-"+r,n=document.getElementById("TableFooterdateInputId");if(n.setAttribute("min",o),n){n.setAttribute("min",o);const d=JSON.parse(localStorage.getItem("DeliveryDateTime"));d?n.value=d:n.value=u}};let De=()=>{j().then(()=>{F(),localStorage.removeItem("PresentOrderAddOns"),$("#table").bootstrapTable("refresh"),$("#AddItemsId")[0].reset(),$("#TableFooterItemNameId").focus(),T(),localStorage.setItem("PresentOrderAddOns",JSON.stringify([]))})},we=async()=>{(await he()).status===200&&De()};const Me=()=>{oe()&&we()};let Ke=()=>{let e=document.getElementById("TableFooterSaveButtonId");e!==null&&e.addEventListener("click",Me)};const M="TableFooterItemServiceId",Pe=e=>{let a=e.currentTarget.value;const l=ke();let o=document.getElementById(M),r=Ve({inCategory:l,inItemType:a});const c=Object.groupBy(r,({Service:i})=>i);let n=Object.keys(c).map(i=>i).sort((i,g)=>i==g?0:i>g?1:-1).sort((i,g)=>i==="DW"?-1:0);for(var d="",s=0;s<n.length;s++)d+=`<option value="${n[s]}">${n[s]}</option>`;o.innerHTML=d,Je()};let ke=()=>document.getElementById("ItemTypeLabelId").dataset.itemCategory,Je=()=>{var e=new Event("change");let t=document.getElementById(M);t!==null&&t.dispatchEvent(e)},Ue=()=>{let e=document.getElementById("TableFooterItemNameId");e!==null&&e.addEventListener("change",Pe)};const h=(e,t,a)=>{xe(e.ItemName),qe(e.Category),We(e.DryWashRate),Ge(1),$("#ItemsOnModal").modal("hide"),document.getElementById("TableFooterSaveButtonId").click()};let xe=e=>{let a=document.getElementById("TableFooterItemNameId");a!==null&&(a.value=e)},qe=e=>{let a=document.getElementById("TableFooterCategoryId");a!==null&&(a.value=e)},We=e=>{let a=document.getElementById("TableFooterRateInputId");a!==null&&(a.value=e)},Ge=e=>{let a=document.getElementById("TableFooterPcsInputId");a!==null&&(a.value=e)};const _e=e=>{let t="ItemsOnModal";var a=$(document.getElementById(t).querySelector("table"));e?(a.bootstrapTable({data:jFLocalFromLocalStorageWithFilter(e),onClickRow:h}),document.getElementById("SearchString").innerHTML=`Search Results for - ${e}`):(a.bootstrapTable({data:jFLocalFromLocalStorage(),onClickRow:h}),document.getElementById("SearchString").innerHTML="All Items"),$(`#${t}`).modal("show")},Ye=()=>{let e=document.getElementById("TableFooterItemNameId").value;_e(e)};let ze=()=>{let e=document.getElementById("TableFooterItemNameSearchButtonId");e!==null&&e.addEventListener("click",Ye)},O=document.getElementById("AddOnModalLocalStorage"),Qe=({inRow:e})=>{const t=Xe(),a=Ze(),l=et();tt(t),at(a),lt(l)},Xe=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},Ze=()=>{let t=document.getElementById("TableFooterRateInputId");if(t!==null)return t.value.trim()},et=()=>{let t=document.getElementById("CustomerNameId");if(t!==null)return t.value.trim()},tt=e=>{const t=O.querySelector(".AddOnModalLocalStorageItemNameClass");t!==null&&(t.value=e)},at=e=>{const t=O.querySelector(".AddOnModalLocalStorageItemRateClass");t!==null&&(t.value=e)},lt=e=>{const t=O.querySelector(".AddOnModalLocalStorageSerialClass");t!==null&&(t.value=e)};const ot=()=>{let e=I.localStorageKeys.PresentOrderAddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},rt="AddOnModalLocalStorageTable",v=()=>{let e=ot();var t=$(`#${rt}`);t.bootstrapTable("load",e===null?[]:e)},nt="AddOnModalLocalStorage",dt=({inRow:e})=>{v();let t=document.getElementById(nt);Qe({inRow:e}),$(t).modal("show")};let ct=()=>{let e=document.getElementById("TableFooterAddOnId");e!==null&&e.addEventListener("click",dt)};const mt=e=>{let a=e.currentTarget.value;debugger;const l=ut(),o=st();let r=p({inCategory:l,inItemType:o,inService:a});It(r.DryWashRate)};let st=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},ut=()=>document.getElementById("ItemTypeLabelId").dataset.itemCategory,It=e=>{let a=document.getElementById("TableFooterRateInputId");a!==null&&(a.value=e)},it=()=>{let e=document.getElementById("TableFooterItemServiceId");e!==null&&e.addEventListener("change",mt)},Lt=()=>!(jt()===!1||Ft()===!1||ft()===!1||St()===!1||yt()===!1||Vt()===!1);const jt=()=>{let e=document.getElementById("TableFooterItemNameId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},Ft=()=>{let e=document.getElementById("TableFooterPcsInputId");return e.value===""||e.value<=0?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},ft=()=>{let e=document.getElementById("exampleFormControlInput1");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},St=()=>{let e=document.getElementById("TableFooterFactoryInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},yt=()=>{let e=document.getElementById("TableFooterdateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},Vt=()=>{let e=document.getElementById("TableFooterRateInputId");return e.value===""?(e.classList.add("is-invalid"),e.focus(),!1):(e.value!==""&&e.classList.remove("is-invalid"),!0)},gt="PUT",bt={Accept:"application/json","Content-Type":"application/json"},pt="",N={method:gt,headers:bt,body:pt},Tt=()=>{let e=vt(),t=$t(),a=At(),l=Bt(),o=Nt(),r=Ct(),c=ht();const m=Ot();localStorage.setItem("DeliveryDateTime",JSON.stringify(c));let u=JSON.parse(localStorage.getItem("PresentOrderAddOns"));const n=p({inCategory:e,inItemType:t,inService:m});let d={};return d.Category=e,d.ItemName=n.ItemName,d.ItemType=t,d.Rate=a,d.Pcs=l,d.Total=o,d.location=r,d.DeliveryDateTime=c,d.ItemService=m,d.AddOnArray=u,d};let Ot=()=>{let t=document.getElementById("TableFooterItemServiceId");if(t!==null)return t.value.trim()},vt=()=>{let e=Array.from(document.querySelectorAll(".CategoryItems")).find(t=>t.classList.contains("btn-primary"));return e?e.textContent.trim():null},$t=()=>{let t=document.getElementById("TableFooterItemNameId");if(t!==null)return t.value.trim()},At=()=>{let t=document.getElementById("TableFooterRateInputId");if(t!==null)return t.value.trim()},Bt=()=>{let t=document.getElementById("TableFooterPcsInputId");if(t!==null)return t.value.trim()},Ct=()=>{let t=document.getElementById("TableFooterFactoryInputId");if(t!==null)return t.value.trim()},ht=()=>{let t=document.getElementById("TableFooterdateInputId");if(t!==null)return t.value.trim()},Nt=()=>{let t=document.getElementById("TableFooterRateInputId"),l=document.getElementById("TableFooterPcsInputId"),o=JSON.parse(localStorage.getItem("PresentOrderAddOns")),r=o!==null?o.map(m=>m.AddOnRate).reduce((m,u)=>m+parseInt(u),0):0,c=parseInt(t.value)+r;return console.log("Total:",c*l.value),c*l.value},Et=()=>(N.body=JSON.stringify(Tt()),N),Ht=async()=>{let e=localStorage.getItem("BranchName"),t=parseInt(document.getElementById("OrderNumberId").innerHTML),a=parseInt(document.getElementById("SubId").innerHTML),l=Et(),o=`/Custom/Cleaning/Branch/Order/SubTable/ItemsInOrder/${t}/${a}/${e}`;return await await fetch(o,l)},Rt=()=>{j().then(()=>{F(),localStorage.removeItem("PresentOrderAddOns"),$("#table").bootstrapTable("refresh"),$("#AddItemsId")[0].reset(),$("#TableFooterItemNameId").focus(),T(),localStorage.setItem("PresentOrderAddOns",JSON.stringify([])),Kt(),Dt(),wt(),Mt()})},Dt=()=>{document.getElementById("SubId").classList.add("d-none")};const wt=()=>{document.getElementById("TableFooterSaveButtonId").classList.remove("d-none")};let Mt=()=>{document.getElementById("TableFooterAlterButtonId").classList.add("d-none")};const Kt=()=>{var e=new Event("change");document.getElementById("TableFooterCategoryId")!==null&&document.getElementById("TableFooterCategoryId").dispatchEvent(e)};let Pt=async()=>{(await Ht()).status===200&&Rt()};const kt=()=>{Lt()&&Pt()};let Jt=()=>{let e=document.getElementById("TableFooterAlterButtonId");e!==null&&e.addEventListener("click",kt)};const Ut=({inCategorySelected:e})=>{let a=document.getElementById("ItemsDataListId"),l=e,r=V().filter(s=>s.Category===l);const c=Object.groupBy(r,({ItemType:s})=>s);let u=Object.keys(c).map(s=>s).sort((s,i)=>s==i?0:s>i?1:-1);for(var n="",d=0;d<u.length;d++)n+=`<option value="${u[d]}">${u[d]}</option>`;a.innerHTML=n,document.getElementById("TableFooterItemNameId").focus()},E="Men";let xt=e=>{Ut({inCategorySelected:E});let t=document.getElementById("ItemTypeLabelId");t.dataset.itemCategory=E,qt(e),Wt()};const qt=e=>{document.querySelectorAll(".CategoryItems").forEach(a=>{a!==e.target&&(a.classList.remove("btn","btn-primary"),a.classList.add("btn","btn-outline-primary"))}),e.target.classList.remove("btn-outline-primary"),e.target.classList.add("btn-primary")},Wt=()=>{const e=document.getElementById("ItemTypeLabelId");e.innerHTML="",e.innerHTML=`<strong>${e.dataset.itemCategory}</strong>-Item Type`};let Gt=()=>{let e=document.getElementById("MenCategoryId");e!==null&&e.addEventListener("click",xt)};const _t=({inCategorySelected:e})=>{let a=document.getElementById("ItemsDataListId"),l=e,r=V().filter(s=>s.Category===l);const c=Object.groupBy(r,({ItemType:s})=>s);let u=Object.keys(c).map(s=>s).sort((s,i)=>s==i?0:s>i?1:-1);for(var n="",d=0;d<u.length;d++)n+=`<option value="${u[d]}">${u[d]}</option>`;a.innerHTML=n,document.getElementById("TableFooterItemNameId").focus()},H="Women";let Yt=e=>{_t({inCategorySelected:H});let t=document.getElementById("ItemTypeLabelId");t.dataset.itemCategory=H,zt(e),Qt()};const zt=e=>{document.querySelectorAll(".CategoryItems").forEach(a=>{a!==e.target&&(a.classList.remove("btn","btn-primary"),a.classList.add("btn","btn-outline-primary"))}),e.target.classList.remove("btn-outline-primary"),e.target.classList.add("btn-primary")},Qt=()=>{const e=document.getElementById("ItemTypeLabelId");e.innerHTML="",e.innerHTML=`<strong>${e.dataset.itemCategory}</strong>-Item Type`};let Xt=()=>{let e=document.getElementById("WomenCategoryId");e!==null&&e.addEventListener("click",Yt)};const Zt=({inCategorySelected:e})=>{let a=document.getElementById("ItemsDataListId"),l=e,r=V().filter(s=>s.Category===l);const c=Object.groupBy(r,({ItemType:s})=>s);let u=Object.keys(c).map(s=>s).sort((s,i)=>s==i?0:s>i?1:-1);for(var n="",d=0;d<u.length;d++)n+=`<option value="${u[d]}">${u[d]}</option>`;a.innerHTML=n,document.getElementById("TableFooterItemNameId").focus()},R="Kids";let ea=e=>{Zt({inCategorySelected:R});let t=document.getElementById("ItemTypeLabelId");t.dataset.itemCategory=R,ta(e),aa()};const ta=e=>{document.querySelectorAll(".CategoryItems").forEach(a=>{a!==e.target&&(a.classList.remove("btn","btn-primary"),a.classList.add("btn","btn-outline-primary"))}),e.target.classList.remove("btn-outline-primary"),e.target.classList.add("btn-primary")},aa=()=>{const e=document.getElementById("ItemTypeLabelId");e.innerHTML="",e.innerHTML=`<strong>${e.dataset.itemCategory}</strong>-Item Type`};let la=()=>{let e=document.getElementById("KidsCategoryId");e!==null&&e.addEventListener("click",ea)};const oa=({inCategorySelected:e})=>{let a=document.getElementById("ItemsDataListId"),l=e,r=V().filter(s=>s.Category===l);const c=Object.groupBy(r,({ItemType:s})=>s);let u=Object.keys(c).map(s=>s).sort((s,i)=>s==i?0:s>i?1:-1);for(var n="",d=0;d<u.length;d++)n+=`<option value="${u[d]}">${u[d]}</option>`;a.innerHTML=n,document.getElementById("TableFooterItemNameId").focus()},D="Others";let ra=e=>{oa({inCategorySelected:D});let t=document.getElementById("ItemTypeLabelId");t.dataset.itemCategory=D,na(e),da()};const na=e=>{document.querySelectorAll(".CategoryItems").forEach(a=>{a!==e.target&&(a.classList.remove("btn","btn-primary"),a.classList.add("btn","btn-outline-primary"))}),e.target.classList.remove("btn-outline-primary"),e.target.classList.add("btn-primary")},da=()=>{const e=document.getElementById("ItemTypeLabelId");e.innerHTML="",e.innerHTML=`<strong>${e.dataset.itemCategory}</strong>-Item Type`};let ca=()=>{let e=document.getElementById("OthersCategoryId");e!==null&&e.addEventListener("click",ra)};const ma=()=>{Gt(),Xt(),la(),ca()},sa=()=>{ma(),ct(),ze(),it(),Ue(),Ke(),Jt()};let ua=()=>{le(),sa()},Ia=async()=>{await j()},ia=({inRow:e})=>{const t=e;La(t.ItemName),ja(t.pk),Fa(t.Rate)},La=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},ja=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},Fa=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const fa=({inRow:e})=>{if(e.AddOnArray.length===0)return;let t=e.AddOnArray;const a=I.ModalIds.AddOnModal;var l=$("#AddOnTable");l.bootstrapTable("load",t),ia({inRow:e}),$(`#${a}`).modal("show")},Sa=async({inRowpk:e,inItemSerial:t})=>{const a=I.ApiUrls.ItemsTable.DeleteItemUrl;let l=localStorage.getItem("BranchName");const o=t;let r=a.replace("$tableName",l).replace(":Id",e).replace(":SubId",o);return await fetch(r,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}})},ya=({inResponse:e})=>{e.status===200&&j().then(t=>{F(),$("#TableFooterItemNameId").focus()})},Va=async({inItemSerial:e})=>{let t=ga(),a=await Sa({inRowpk:t,inItemSerial:e});ya({inResponse:a})},ga=()=>{let e=I.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t).pk},ba=async({inRowpk:e,inItemSerial:t})=>{const a=I.ApiUrls.ItemsTable.AlterGetUrl;let l=localStorage.getItem("BranchName");const o=t;let r=a.replace("$tableName",l).replace(":Id",e).replace(":SubId",o);return await fetch(r)},pa=e=>{let a=JSON.parse(localStorage.getItem("ItemNames")).find(l=>l.ItemName==e.ItemName);Ta({inValue:e.Category}),Oa({inValue:a.ItemType}),va({inValue:e.ItemService}),$a({inValue:e.Rate}),Aa({inValue:e.Pcs}),Ba({inValue:e.location}),Ca({inValue:e.DeliveryDateTime}),ha({inValue:e.SubKey}),Na(),Ea(),localStorage.setItem("PresentOrderAddOns",JSON.stringify(e.AddOnArray))};let Ta=({inValue:e})=>{let t=Array.from(document.querySelectorAll(".CategoryItems")).find(a=>a.textContent.trim()===e);t&&t.click()},Oa=({inValue:e})=>{let a=document.getElementById("TableFooterItemNameId");a!==null&&(a.value=e)},va=({inValue:e})=>{let a=document.getElementById("TableFooterItemServiceId");a!==null&&(a.value=e)},$a=({inValue:e})=>{let a=document.getElementById("TableFooterRateInputId");a!==null&&(a.value=e)},Aa=({inValue:e})=>{let a=document.getElementById("TableFooterPcsInputId");a!==null&&(a.value=e)},Ba=({inValue:e})=>{let a=document.getElementById("TableFooterFactoryInputId");a!==null&&(a.value=e)},Ca=({inValue:e})=>{let a=document.getElementById("TableFooterdateInputId");a!==null&&(a.value=e)},ha=({inValue:e})=>{let a=document.getElementById("SubId");a.classList.remove("d-none"),a!==null&&(a.innerHTML=e),e===void 0&&(a.innerHTML=0)};const Na=()=>{document.getElementById("TableFooterSaveButtonId").classList.add("d-none")};let Ea=()=>{document.getElementById("TableFooterAlterButtonId").classList.remove("d-none")};const Ha=async({inResponse:e})=>{e.status===200&&pa(await e.json())},Ra=async({inItemSerial:e})=>{let t=Da(),a=await ba({inRowpk:t,inItemSerial:e});Ha({inResponse:a})},Da=()=>{let e=I.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t).pk},wa=(e,t,a)=>{a==="KS-AddOns"&&fa({inRow:e}),a==="KS-Opts"&&Swal.fire({title:"Check",text:"Do you really want to Delete Item?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Edit",denyButtonText:"Delete"}).then(l=>{l.isConfirmed?Ra({inItemSerial:e.pk}):l.isDenied&&Va({inItemSerial:e.pk})})};let Ma=()=>{},Ka=({inFindColumn:e})=>{e.formatter=Pa},Pa=(e,t,a)=>a+1;const ka=({inFindColumn:e})=>{e.formatter=Ja},Ja=(e,t)=>{const a=t.AddOnArray;if(a&&a.length>0){const l=a.reduce((o,r)=>o+r.AddOnRate,0);return`<a href="#" class="btn btn-primary ">${a.length}-${l}</a>`}return"No"};let Ua=({inFindColumn:e})=>{e.formatter=xa};function xa(e,t,a){return['<a href="#" class="link-danger">','<i class="bi bi-trash3"></i>',"</a>"].join("")}let qa=({inFindColumn:e})=>{e.formatter=Wa,e.footerFormatter=Ga};function Wa(e,t,a){let l=localStorage.getItem("PresentOrder"),o=JSON.parse(l),r=t.ItemSerial,c=Object.values(o.AddOnData).filter(m=>m.AddOnItemSerial===r);return c.length>0?c.map(u=>u.AddOnRate).reduce((u,n)=>u+n,0)*t.Pcs+t.Total:t.Total}function Ga(e){return this.field,"â‚¹ "+e.map(function(t){return+t.Total}).reduce(function(t,a){return t+a},0)}let _a=({inFindColumn:e})=>{e.footerFormatter=""},Ya=({inFindColumn:e})=>{e.footerFormatter=za};function za(e){var t=this.field;return e.map(function(l){return l[t]===void 0?0:+l[t]}).reduce(function(l,o){return l+o},0).toFixed(0)}let Qa=({inFindColumn:e})=>{e.formatter=Xa},Xa=(e,t,a)=>new Date(e).toLocaleDateString("en-GB"),Za=({inColumns:e})=>{let t=e,a=t.find(n=>n.field==="KS-Serial");t.find(n=>n.field==="Rate");let l=t.find(n=>n.field==="KS-AddOns"),o=t.find(n=>n.field==="KS-Opts"),r=t.find(n=>n.field==="KS-Amount"),c=t.find(n=>n.field==="Category");t.find(n=>n.field==="ItemName");let m=t.find(n=>n.field==="Pcs");t.find(n=>n.field==="location");let u=t.find(n=>n.field==="DeliveryDateTime");t.find(n=>n.field==="ItemService"),a!==void 0&&Ka({inFindColumn:a}),l!==void 0&&ka({inFindColumn:l}),o!==void 0&&Ua({inFindColumn:o}),r!==void 0&&qa({inFindColumn:r}),c!==void 0&&_a({inFindColumn:c}),m!==void 0&&Ya({inFindColumn:m}),u!==void 0&&Qa({inFindColumn:u})};const el=(e,t)=>e.ItemService==="PW"?{classes:"table-warning"}:{},tl=[],al="true",ll=[{field:"KS-Serial",title:"#",width:5,widthUnit:"%"},{field:"Category",title:"Category",width:10,widthUnit:"%",visible:!1},{field:"ItemName",title:"Item Name",width:10,widthUnit:"%"},{field:"ItemService",title:"Service",width:10,widthUnit:"%"},{field:"KS-AddOns",title:"Add Ons",width:100},{field:"Rate",title:"Rate",align:"right",footerFormatter:"",width:10,widthUnit:"%"},{field:"Pcs",title:"Pcs",align:"right",width:8,widthUnit:"%"},{field:"KS-Amount",title:"Amount",align:"right",footerFormatter:"",width:15,widthUnit:"%"},{field:"location",title:"Factory",width:200},{field:"DeliveryDateTime",title:"Delivery",width:10,widthUnit:"%"},{field:"KS-Opts",title:"",width:100}],ol="",rl="",L={data:tl,showFooter:al,columns:ll,onPostBody:ol,onClickRow:rl},nl=()=>{var e=$("#table");L.onPostBody=Ma,L.onClickRow=wa,L.rowStyle=el,Za({inColumns:L.columns}),e.bootstrapTable(L)};let dl=({inRow:e})=>{const t=e;cl(t.ItemName),ml(t.pk),sl(t.Rate)},cl=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},ml=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},sl=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const ul=({inRow:e})=>{let t=Il({inItemSerial:parseInt(e.pk)});var a=$("#AddOnTable");a.bootstrapTable("load",t),dl({inRow:e}),$("#AddOnModal").modal("show")};let Il=({inItemSerial:e})=>{let t=I.localStorageKeys.OrderKey,a=localStorage.getItem(t),l=JSON.parse(a),o=e;return Object.keys(l.AddOnData).map(m=>S(f({},l.AddOnData[m]),{AddOnPK:m})).filter(m=>m.AddOnItemSerial===o)};const il=async({inRowpk:e,inItemSerial:t})=>{const a=I.ApiUrls.ItemsTable.DeleteAddOnUrl;let l=localStorage.getItem("BranchName");const o=t;let r=Ll(),c=a.replace("$tableName",l).replace(":Id",e).replace(":SubId",r).replace(":AddOnKey",o);return await fetch(c,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}})};let Ll=()=>{let t=document.getElementById("AddOnModalItemSerialId");if(t!==null)return t.value.trim()};const jl=({inResponse:e})=>{e.status===200&&(Fl("AddOnModal"),j().then(t=>{F(),$("#TableFooterItemNameId").focus()}))};function Fl(e){const t=document.querySelector("#"+e),a=bootstrap.Modal.getInstance(t);a!=null&&a.hide()}const fl=async({inItemSerial:e})=>{let t=Sl(),a=await il({inRowpk:t,inItemSerial:e});jl({inResponse:a})},Sl=()=>{let e=I.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t).pk},yl=(e,t,a)=>{console.log("row : ",e),a==="KS-AddOns"&&ul({inRow:e}),a==="KS-Opts"&&window.confirm("Do you really want to Delete Item?")&&fl({inItemSerial:e.AddOnService})};let Vl=({inFindColumn:e})=>{e.formatter=gl},gl=(e,t,a)=>a+1,bl=({inFindColumn:e})=>{e.formatter=pl};function pl(e,t,a){return['<a href="#" class="link-danger">','<i class="bi bi-trash3"></i>',"</a>"].join("")}let Tl=({inFindColumn:e})=>{e.footerFormatter=Ol};function Ol(e){var t=this.field;return e.map(function(l){return l[t]===void 0?0:+l[t]}).reduce(function(l,o){return l+o},0).toFixed(2)}let vl=({inColumns:e})=>{let t=e,a=t.find(r=>r.field==="KS-Serial"),l=t.find(r=>r.field==="KS-Opts"),o=t.find(r=>r.field==="AddOnRate");a!==void 0&&Vl({inFindColumn:a}),l!==void 0&&bl({inFindColumn:l}),o!==void 0&&Tl({inFindColumn:o})};const $l=[],Al=[{field:"KS-Serial",title:"#",width:75},{field:"AddOnService",title:"Service",width:400},{field:"AddOnRate",title:"Rate",width:200},{field:"KS-Opts",title:"",width:100}],Bl="",b={data:$l,columns:Al,onClickRow:Bl},Cl="AddOnTable",hl=()=>{var e=$(`#${Cl}`);b.onClickRow=yl,vl({inColumns:b.columns}),e.bootstrapTable(b)};let Nl=({inRow:e})=>{const t=e;El(t.ItemName),Hl(t.pk),Rl(t.Rate)},El=e=>{let a=document.getElementById("AddOnModalItemNameId");a!==null&&(a.value=e)},Hl=e=>{let a=document.getElementById("AddOnModalItemSerialId");a!==null&&(a.value=e)},Rl=e=>{let a=document.getElementById("exampleFormControlInput1");a!==null&&(a.value=e)};const K=()=>{let e=I.localStorageKeys.PresentOrderAddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},Dl=({inAddOnService:e})=>K().find(l=>l.AddOnService===e)===void 0,P=()=>{if(!wl())return!1;const e=Ml();return Dl({inAddOnService:e})!==!1},wl=()=>{const e=document.getElementById("TableFooterAddOnSelectId");return e.value.trim()?(e.classList.remove("is-invalid"),!0):(e.classList.add("is-invalid"),e.focus(),!1)},Ml=()=>{const e=document.getElementById("TableFooterAddOnSelectId");return e?e.value.trim():void 0},Kl=({inRow:e})=>{P();let t=Pl({inItemSerial:parseInt(e.pk)});var a=$("#AddOnTable");a.bootstrapTable("load",t),Nl({inRow:e}),$("#AddOnModal").modal("show")};let Pl=({inItemSerial:e})=>{let t=I.localStorageKeys.OrderKey,a=localStorage.getItem(t),l=JSON.parse(a),o=e;return Object.keys(l.AddOnData).map(m=>S(f({},l.AddOnData[m]),{AddOnPK:m})).filter(m=>m.AddOnItemSerial===o)};const kl=({inRowIndex:e})=>{Ul({inRowIndex:e}),v(),Jl()};let Jl=()=>{let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.focus()};const Ul=({inRowIndex:e})=>{let t=I.localStorageKeys.PresentOrderAddOnsKey,a=localStorage.getItem(t),l=JSON.parse(a);l.splice(e,1),localStorage.setItem(t,JSON.stringify(l))},xl=(e,t,a)=>{if(console.log("row------------ : ",e,t[0].dataset.index,a),a==="KS-AddOns"&&Kl({inRow:e}),a==="KS-Opts"&&window.confirm("Do you really want to Delete Item?")){const l=t[0].dataset.index;kl({inRowIndex:parseInt(l)})}},ql=()=>{let e=Gl(),t=Wl(),a=_l(),l={};return l.AddOnService=e,l.AddOnRate=parseInt(t),l.AddOnItemSerial=parseInt(a),l};let Wl=()=>{let t=document.getElementById("AddOnRateId");return t===null||t.value.trim()===""?0:t.value.trim()},Gl=()=>{let t=document.getElementById("TableFooterAddOnSelectId");if(t!==null)return t.value.trim()},_l=()=>{let t=document.getElementById("AddOnModalItemSerialId");if(t!==null)return t.value.trim()};const Yl=()=>{const e=ql();zl({inAddOnRow:e})},zl=({inAddOnRow:e})=>{let t=I.localStorageKeys.PresentOrderAddOnsKey,a=localStorage.getItem(t);if(a===null){localStorage.setItem(t,JSON.stringify([e]));return}let l=JSON.parse(a);l.push(e),localStorage.setItem(t,JSON.stringify(l))},Ql=()=>{const e=P();console.log(" : ",e),e?(Yl(),v(),Xl()):Zl()};let Xl=()=>{let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.focus()};const Zl=()=>{const e=document.getElementById("TableFooterAddOnSelectId");e.classList.add("is-invalid"),e.addEventListener("click",()=>e.classList.remove("is-invalid"))};let eo=()=>{let e=document.getElementById("AddOnModalSaveButtonId");e!==null&&e.addEventListener("click",Ql)};const to=()=>{let e=I.localStorageKeys.AddOnsKey,t=localStorage.getItem(e);return JSON.parse(t)},ao=()=>{let e=document.getElementById("TableFooterAddOnSelectId");lo(e);let t=to();for(var a=0;a<t.length;a++){let l=document.createElement("option");l.value=t[a].AddOnService,l.innerHTML=t[a].AddOnService,e.appendChild(l)}};let lo=e=>{let t=document.createElement("option");t.value="",t.innerHTML="Select Add-On ",e.appendChild(t)};const oo="AddOns",ro=()=>{const e=event.currentTarget,t=co({inAddOnData:e.value});mo(t)},no=()=>{const e=localStorage.getItem(oo);return JSON.parse(e)},co=({inAddOnData:e})=>{const a=no().find(l=>l.AddOnService===e);return a===void 0?0:a.AddOnRate};let mo=e=>{let a=document.getElementById("AddOnRateId");a!==null&&(a.value=e)};const so=e=>{e.currentTarget,e.key==="Enter"&&uo()};let uo=()=>{var e=new Event("click");let t=document.getElementById("AddOnModalSaveButtonId");t!==null&&t.dispatchEvent(e)},Io=()=>{let e=document.getElementById("TableFooterAddOnSelectId");e!==null&&e.addEventListener("change",ro),e!==null&&e.addEventListener("keypress",so)},io=()=>{eo(),ao(),Io(),Lo(),$("#TableFooterItemNameId").focus()},Lo=()=>{var e=new Event("change");let t=document.getElementById("TableFooterAddOnSelectId");t!==null&&t.dispatchEvent(e)},jo=({inFindColumn:e})=>{e.formatter=Fo},Fo=(e,t,a)=>a+1,fo=({inFindColumn:e})=>{e.footerFormatter=So},So=e=>`<input type="number" name="AddOnRate" id="AddOnRateId" class="form-control"
                                placeholder="AddOn Rate">`,yo=({inFindColumn:e})=>{e.formatter=Vo,e.footerFormatter=go};function Vo(e,t,a){return['<a href="#" class="btn btn-danger ">','<i class="bi bi-trash3"></i>',"</a>"].join("")}const go=e=>`   <button type="button" class="btn btn-primary" id="AddOnModalSaveButtonId">
                                Save
                            </button>`;let bo=({inFindColumn:e})=>{e.footerFormatter=po};const po=(e,t,a)=>`  <select class="form-select" aria-label="Select AddOn" id="TableFooterAddOnSelectId">
                            </select>`;let To=({inColumns:e})=>{let t=e,a=t.find(c=>c.field==="KS-Serial"),l=t.find(c=>c.field==="KS-Opts"),o=t.find(c=>c.field==="AddOnService"),r=t.find(c=>c.field==="AddOnRate");a!==void 0&&jo({inFindColumn:a}),l!==void 0&&yo({inFindColumn:l}),o!==void 0&&bo({inFindColumn:o}),r!==void 0&&fo({inFindColumn:r})};const Oo=[],vo=[{field:"KS-Serial",title:"#",width:75},{field:"AddOnService",title:"Service",width:400},{field:"AddOnRate",title:"Rate",width:200},{field:"KS-Opts",title:"Options",width:100}],$o="",Ao="",y={data:Oo,columns:vo,onPostBody:$o,onClickRow:Ao},Bo="AddOnModalLocalStorage",Co=()=>{let t=document.getElementById(Bo).querySelector("table");var a=$(t);y.onPostBody=io,y.onClickRow=xl,To({inColumns:y.columns}),a.bootstrapTable(y)},ho=()=>{nl(),hl(),Co()},No=async()=>{He(),ho(),await Ia(),ua()},Eo=()=>{let e=I.localStorageKeys.OrderKey,t=localStorage.getItem(e);return JSON.parse(t)},Ho=()=>{let e=Eo();Mo(e.CustomerData.inMobileNumber),wo(e.CustomerData.CustomerName),Do(e.pk),Ro(localStorage.getItem("BranchName"))};let Ro=e=>{let a=document.getElementById("BranchNameAnchorId"),l=e.replace("BranOrders","");a!==null&&(a.innerHTML=l)},Do=e=>{let a=document.getElementById("OrderNumberId");a!==null&&(a.innerHTML=e)},wo=e=>{let a=document.getElementById("CustomerNameId");a!==null&&(a.value=e)},Mo=e=>{let a=document.getElementById("CustomerMobileId");a!==null&&(a.value=e)};const w=()=>{F(),Ho()},Ko=()=>{let e=I.localStorageKeys.PresentOrderAddOnsKey;K()===null&&localStorage.setItem(e,JSON.stringify([]))},Po=async()=>{await No(),W({inSuccessFunc:w})&&(Ko(),w(),ko())};let ko=()=>{let e=document.getElementById("MenCategoryId");e!==null&&e.click()};Po().then();
